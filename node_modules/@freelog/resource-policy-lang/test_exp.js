'use strict'


const antlr4 = require('antlr4/index')
const ExpressionVisitor = require('./EXPGenerator')
const ExpressionLexer = require('./gen/expressionLexer')
const ExpressionParser = require('./gen/expressionParser')

const input = 'sum(1+2)'

const chars = new antlr4.InputStream(input);
const lexer = new ExpressionLexer.expressionLexer(chars);
const tokens = new antlr4.CommonTokenStream(lexer);
const parser = new ExpressionParser.expressionParser(tokens);
parser.buildParseTrees = true;

const tree = parser.prog()
const myExpressionVisitor = new ExpressionVisitor()

myExpressionVisitor.visit(tree)

console.log(`表达式${input}计算结果:${myExpressionVisitor.result}`)

if(myExpressionVisitor.errorMsg){
    console.log(myExpressionVisitor.errorMsg)
}

